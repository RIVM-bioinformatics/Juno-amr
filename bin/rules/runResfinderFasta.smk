rule runResfinderFasta:
    """Trying to run resfinder with hardcoded paths and all packages installed in a environment generated by conda/snakemake"""
    input:
        #Samples retrieved from config.yml
        lambda wildcards: config["samples_fasta"][wildcards.sample]

    output:
        #One of the output files that is requested by rule all
        output_file = "output/{sample}/PointFinder_results.txt",
        #Make an output directory per sample
        output_dir = directory("output/{sample}")
    
    conda:
    #TODO put this command in a config for easy access
        "../../envs/resfinder.yml"
    
    message:
        "Processing received samples in resfinder"

    params:
    #get parameters from configfile
        l = config["Parameters"]["coverage"],
        t = config["Parameters"]["threshold"],
        species = config["Parameters"]["species"]

    shell:
        # Command to call resfinder
        "python3 resfinder/run_resfinder.py -o {output.output_dir} -s \"{params.species}\" -l {params.l} -t {params.t} --acquired --point -ifa {input}"

